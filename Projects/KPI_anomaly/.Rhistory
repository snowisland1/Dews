plot(cars)
#load data
submit<-read.csv("../../dataset/anomaly_detection_1/train.csv")
#load data
submit<-read.csv("../../dataset/anomaly_detection_1/test_dataset.csv")
summary(submit)
submit$predict<-1
head(submit)
write.csv(submit,"./results/all1.csv",quote = F,row.names = F)
write.csv(submit[,c(1,2,4)],"./results/all1.csv",quote = F,row.names = F)
train<-read.csv("../../dataset/anomaly_detection_1/train.csv")
submit<-read.csv("../../dataset/anomaly_detection_1/test_dataset.csv")
View(train)
unique(train$KPI.ID)
KPI_IDs<-unique(train$KPI.ID)
tmp_line<-train[which(train$KPI.ID == KPI_IDs[1]),]
View(tmp_line)
sum(tmp_line$label)
for(i in c(1:27)){
tmp_line<-train[which(train$KPI.ID == KPI_IDs[i]),]
print(paste(as.character(length(tmp_line[,1])),as.character(sum(tmp_line$label)),sep = "|"))
}
sum(train$label)
24339/2617679
tmp_line<-train[which(train$KPI.ID == KPI_IDs[1]),]
View(tmp_line)
KPI_IDs[1]
KPI_IDs[2]
KPI_IDs[3]
KPI_IDs[4]
tmp_line<-train[which(train$KPI.ID == KPI_IDs[4]),]
View(tmp_line)
sum(tmp_line$label)
2*0.1*1/(1.1)
submit<-read.csv("../../dataset/anomaly_detection_1/test_dataset.csv")
View(submit)
train<-read.csv("../../dataset/anomaly_detection_1/train.csv")
View(train)
train["predict"]<-1
write.csv("predict.csv",train[,c(1,2,5)],row.names = F,quote = F)
write.csv("./predict.csv",train[,c(1,2,5)],row.names = F,quote = F)
write.csv(train[,c(1,2,5)],"./predict.csv",row.names = F,quote = F)
submit<-read.csv("../../dataset/anomaly_detection_1/test_dataset.csv")
train<-read.csv("../../dataset/anomaly_detection_1/train.csv")
for(i in c(1:27)){
tmp_line<-train[which(train$KPI.ID == KPI_IDs[4]),]
print(paste(as.character(length(tmp_line[,1])),as.character(sum(tmp_line$label)),sep = "|"))
}
KPI_IDs<-unique(train$KPI.ID)
for(i in c(1:27)){
tmp_line<-train[which(train$KPI.ID == KPI_IDs[4]),]
print(paste(as.character(length(tmp_line[,1])),as.character(sum(tmp_line$label)),sep = "|"))
}
for(i in c(1:27)){
tmp_line<-train[which(train$KPI.ID == KPI_IDs[i]),]
print(paste(as.character(length(tmp_line[,1])),as.character(sum(tmp_line$label)),sep = "|"))
}
tmp_line<-train[which(train$KPI.ID == KPI_IDs[1]),]
View(tmp_line)
library(xts)
xts1<-xts(tmp_line$value,tmp_line$timestamp)
as.POSIXct(tmp_line$timestamp)
as.POSIXct(tmp_line$timestamp[1])
as.Date(as.POSIXct(tmp_line$timestamp, origin="1970-01-01"))
as.POSIXct(tmp_line$timestamp, origin="1970-01-01")
xts1<-xts(tmp_line[,c(3,4)],as.POSIXct(tmp_line$timestamp, origin="1970-01-01"))
View(xts1)
plot(xts1[1:100])
plot(xts1[1:200])
plot(xts1[1:500])
plot(xts1[1:900])
plot(xts1[1:1000])
plot(xts1[1:2000])
plot(xts1[1:3000])
plot(xts1[1:5000])
plot(xts1[1:9000])
plot(xts1[1:10000])
plot(xts1[1:50000])
xts1[1,'label']
tmp_line[1,"label"]
tmp_line$datetime<-as.POSIXct(tmp_line$timestamp, origin="1970-01-01")
View(tmp_line)
hour(tmp_line[1,"datetime"])
library(lur)
tmp_line[1,"datetime"]
tmp_line[1,"datetime"].hour
tmp_line[1,"datetime"]$hour
as.POSIXct(tmp_line[1,"datetime"])
as.POSIXct(tmp_line[1,"datetime"])$hour
names(as.POSIXct(tmp_line[1,"datetime"]))
library(lubridate)
hour(tmp_line[1,"datetime"])
hour(tmp_line[2,"datetime"])
minute(tmp_line[1,"datetime"])
samples<-NULL
order<-1
for(i in 1:length(xts1)){
samples$label[order]<-as.numeric(tmp_line[i,'label'])
samples$hour[order]<-hour(tmp_line[i,"datetime"])
samples$minute[order]<-hour(tmp_line[i,"datetime"])
samples$value[prder]<-tmp_line[i,"value"]
}
samples<-NULL
order<-1
for(i in 1:length(xts1)){
samples$label[order]<-as.numeric(tmp_line[i,'label'])
samples$hour[order]<-hour(tmp_line[i,"datetime"])
samples$minute[order]<-hour(tmp_line[i,"datetime"])
samples$value[order]<-tmp_line[i,"value"]
order<-order+1
}
samples<-data.frame(samples)
View(samples)
write.csv(samples,"./samples/samples1.csv",row.names = F,quote = F)
sum(is.na(samples$label))
sum(is.na(samples$hour))
samples<-NULL
order<-1
for(i in 1:nrow(tmp_line)){
samples$label[order]<-as.numeric(tmp_line[i,'label'])
samples$hour[order]<-hour(tmp_line[i,"datetime"])
samples$minute[order]<-hour(tmp_line[i,"datetime"])
samples$value[order]<-tmp_line[i,"value"]
order<-order+1
}
samples<-data.frame(samples)
write.csv(samples,"./samples/samples1.csv",row.names = F,quote = F)
samples<-NULL
order<-1
for(i in 1:nrow(tmp_line)){
samples$id[order]<-tmp_line[i,"KPI.ID"]
samples$timestamp<-tmp_line[i,"timestamp"]
samples$label[order]<-as.numeric(tmp_line[i,'label'])
samples$hour[order]<-hour(tmp_line[i,"datetime"])
samples$minute[order]<-hour(tmp_line[i,"datetime"])
samples$value[order]<-tmp_line[i,"value"]
order<-order+1
}
samples<-data.frame(samples)
View(samples)
View(tmp_line)
samples<-NULL
order<-1
for(i in 1:nrow(tmp_line)){
samples$id[order]<-tmp_line[i,1]
samples$timestamp<-tmp_line[i,"timestamp"]
samples$label[order]<-as.numeric(tmp_line[i,'label'])
samples$hour[order]<-hour(tmp_line[i,"datetime"])
samples$minute[order]<-hour(tmp_line[i,"datetime"])
samples$value[order]<-tmp_line[i,"value"]
order<-order+1
}
samples<-data.frame(samples)
View(samples)
as.character(tmp_line[1,1])
samples<-NULL
order<-1
for(i in 1:nrow(tmp_line)){
samples$id[order]<-as.character(tmp_line[i,1])
samples$timestamp<-tmp_line[i,"timestamp"]
samples$label[order]<-as.numeric(tmp_line[i,'label'])
samples$hour[order]<-hour(tmp_line[i,"datetime"])
samples$minute[order]<-hour(tmp_line[i,"datetime"])
samples$value[order]<-tmp_line[i,"value"]
order<-order+1
}
samples<-data.frame(samples)
View(samples)
write.csv(samples,"./samples/samples1.csv",row.names = F,quote = F)
samples<-NULL
order<-1
for(i in 1:nrow(tmp_line)){
samples$id[order]<-as.character(tmp_line[i,1])
samples$timestamp<-tmp_line[i,"timestamp"]
samples$label[order]<-as.numeric(tmp_line[i,'label'])
samples$hour[order]<-hour(tmp_line[i,"datetime"])
samples$minute[order]<-minute(tmp_line[i,"datetime"])
samples$minute2[order]<-hour(tmp_line[i,"datetime"])*60+minute(tmp_line[i,"datetime"])
samples$value[order]<-tmp_line[i,"value"]
order<-order+1
}
write.csv(samples,"./samples/samples1.csv",row.names = F,quote = F)
tmp_line[1,"timestamp"]
samples<-NULL
order<-1
for(i in 1:nrow(tmp_line)){
samples$id[order]<-as.character(tmp_line[i,1])
samples$timestamp[order]<-tmp_line[i,"timestamp"]
samples$label[order]<-as.numeric(tmp_line[i,'label'])
samples$hour[order]<-hour(tmp_line[i,"datetime"])
samples$minute[order]<-minute(tmp_line[i,"datetime"])
samples$minute2[order]<-hour(tmp_line[i,"datetime"])*60+minute(tmp_line[i,"datetime"])
samples$value[order]<-tmp_line[i,"value"]
order<-order+1
}
write.csv(samples,"./samples/samples1.csv",row.names = F,quote = F)
samples<-data.frame(samples)
View(samples)
samples_train<-samples
samples_train<-samples[which(samples$label==0) ï¼Œ]
samples_train<-samples[which(samples$label==0),]
View(samples_train)
log(samples$value)
log(samples$value+1)
max(log(samples$value+1))
min(log(samples$value+1))
plot(density(samples_train$value))
plot(density(log(samples_train$value+1)))
samples_train<-samples[which(samples$label==0),]
library(dplyr)
group<-group_by(samples_train,hour,minute)
sta1<-summarise(group,median<-median(value))
View(sta1)
samples<-merge(samples,sta1,by.x = c("hour","minute"),by.y = c("hour","minute"))
View(samples)
samples<-samples[,-8]
sta1<-summarise(group,median=median(value))
samples<-merge(samples,sta1,by.x = c("hour","minute"),by.y = c("hour","minute"))
samples$diff<-abs(samples$median-samples$value)
samples$predict=0
sum(samples$label)
sum(samples$diff>3)
sum(samples$diff>2)
sum(samples$diff>1)
samples[samples$diff>1,"label"]
sum(samples[samples$diff>1,"label"])
length(samples[samples$diff>1,"label"])
627/2322
627/2131
2*0.2700258*0.2942281
2*0.2700258*0.2942281/(0.2700258+0.2942281)
length(samples[samples$diff>1.5,"label"])
sum(samples[samples$diff>1.5,"label"])
407/1134
407/2131
2*(0.3589065*0.1909901)/(0.1909901+0.3589065)
sum(samples[samples$diff>2,"label"])
length(samples[samples$diff>2,"label"])
94/446
length(samples[samples$diff>0.8,"label"])
sum(samples[samples$diff>0.8,"label"])
samples$value<-log(samples$value)
group<-group_by(samples_train,hour,minute)
sta1<-summarise(group,median=median(value))
samples$diff<-abs(samples$median-samples$value)
samples<-NULL
order<-1
for(i in 1:nrow(tmp_line)){
samples$id[order]<-as.character(tmp_line[i,1])
samples$timestamp[order]<-tmp_line[i,"timestamp"]
samples$label[order]<-as.numeric(tmp_line[i,'label'])
samples$hour[order]<-hour(tmp_line[i,"datetime"])
samples$minute[order]<-minute(tmp_line[i,"datetime"])
samples$minute2[order]<-hour(tmp_line[i,"datetime"])*60+minute(tmp_line[i,"datetime"])
samples$value[order]<-tmp_line[i,"value"]
order<-order+1
}
samples$value<-log(samples$value+1)
group<-group_by(samples_train,hour,minute)
sta1<-summarise(group,median=median(value))
samples$diff<-abs(samples$median-samples$value)
samples<-NULL
order<-1
for(i in 1:nrow(tmp_line)){
samples$id[order]<-as.character(tmp_line[i,1])
samples$timestamp[order]<-tmp_line[i,"timestamp"]
samples$label[order]<-as.numeric(tmp_line[i,'label'])
samples$hour[order]<-hour(tmp_line[i,"datetime"])
samples$minute[order]<-minute(tmp_line[i,"datetime"])
samples$minute2[order]<-hour(tmp_line[i,"datetime"])*60+minute(tmp_line[i,"datetime"])
samples$value[order]<-tmp_line[i,"value"]
order<-order+1
}
samples<-data.frame(samples)
samples$value<-log(samples$value+1)
group<-group_by(samples_train,hour,minute)
sta1<-summarise(group,median=median(value))
samples$diff<-abs(samples$median-samples$value)
group<-group_by(samples,hour,minute)
sta1<-summarise(group,median=median(value))
samples$diff<-abs(samples$median-samples$value)
View(samples)
group<-group_by(samples,hour,minute)
sta1<-summarise(group,median=median(value))
samples<-merge(samples,sta1,by.x = c("hour","minute"),by.y = c("hour","minute"))
samples$diff<-abs(samples$median-samples$value)
View(samples)
plot(density(samples[which(samples$label==1),"diff"]))
length(samples[samples$diff>0.1,"label"])
length(samples[samples$diff>0.2,"label"])
sum(samples[samples$diff>0.2,"label"])
sum(samples[samples$diff>0.3,"label"])
lenght(samples[samples$diff>0.3,"label"])
length(samples[samples$diff>0.3,"label"])
samples$rate<-samples$diff/samples$median
plot(density(samples[which(samples$label==1),"rate"]))
length(samples[samples$rate>0.3,"label"])
sum(samples[samples$rate>0.3,"label"])
sum(samples[samples$rate>0.5,"label"])
length(samples[samples$rate>0.5,"label"])
531/2122
531/1407
0.2502356*0.3773987/(0.3773987+0.2502356)
0.2502356*0.3773987/(0.3773987+0.2502356)*2
samples<-NULL
order<-1
for(i in 1:nrow(tmp_line)){
samples$id[order]<-as.character(tmp_line[i,1])
samples$timestamp[order]<-tmp_line[i,"timestamp"]
samples$label[order]<-as.numeric(tmp_line[i,'label'])
samples$hour[order]<-hour(tmp_line[i,"datetime"])
samples$minute[order]<-minute(tmp_line[i,"datetime"])
samples$minute2[order]<-hour(tmp_line[i,"datetime"])*60+minute(tmp_line[i,"datetime"])
samples$value[order]<-tmp_line[i,"value"]
order<-order+1
}
samples<-data.frame(samples)
samples$value<-log(samples$value+1)
samples_train<-samples[which(samples$label==0),]
group<-group_by(samples_train,hour,minute)
sta1<-summarise(group,median=median(value),mean=mean(value))
samples<-merge(samples,sta1,by.x = c("hour","minute"),by.y = c("hour","minute"))
samples$diff1<-abs(samples$median-samples$value)
samples$diff2<-abs(samples$mean-samples$median)
View(samples)
samples$diff2<-abs(samples$mean-samples$value)
sum(samples[samples$diff1>0.5,"label"])
sum(samples[samples$diff1>0.4,"label"])
sum(samples[samples$diff1>0.3,"label"])
sum(samples[samples$diff1>0.2,"label"])
length(samples[samples$diff1>0.2,"label"])
length(samples[samples$diff1>0.3,"label"])
length(samples[samples$diff1>0.4,"label"])
length(samples[samples$diff2>0.4,"label"])
sum(samples[samples$diff2>0.4,"label"])
samples$predict<-0
write.csv(samples,"./samples/samples1.csv",row.names = F,quote = F)
samples$diff1=samples$diff1/samples$median
write.csv(samples,"./samples/samples1.csv",row.names = F,quote = F)
3/2
as.integer(3/2)
samples<-NULL
order<-1
for(i in 1:nrow(tmp_line)){
samples$id[order]<-as.character(tmp_line[i,1])
samples$timestamp[order]<-tmp_line[i,"timestamp"]
samples$label[order]<-as.numeric(tmp_line[i,'label'])
samples$hour[order]<-hour(tmp_line[i,"datetime"])
samples$minute[order]<-as.integer(minute(tmp_line[i,"datetime"])/3)
samples$value[order]<-tmp_line[i,"value"]
order<-order+1
}
samples<-data.frame(samples)
samples$value<-log(samples$value+1)
samples_train<-samples[which(samples$label==0),]
group<-group_by(samples_train,hour,minute)
sta1<-summarise(group,median=median(value),mean=mean(value))
samples<-merge(samples,sta1,by.x = c("hour","minute"),by.y = c("hour","minute"))
samples$diff1<-abs(samples$median-samples$value)
samples$diff2<-abs(samples$mean-samples$value)
tmp_line<-train[which(train$KPI.ID == KPI_IDs[2]),]
tmp_line$datetime<-as.POSIXct(tmp_line$timestamp, origin="1970-01-01")
samples<-NULL
order<-1
for(i in 1:nrow(tmp_line)){
samples$id[order]<-as.character(tmp_line[i,1])
samples$timestamp[order]<-tmp_line[i,"timestamp"]
samples$label[order]<-as.numeric(tmp_line[i,'label'])
samples$hour[order]<-hour(tmp_line[i,"datetime"])
samples$minute[order]<-as.integer(minute(tmp_line[i,"datetime"])/3)
samples$value[order]<-tmp_line[i,"value"]
order<-order+1
}
samples<-data.frame(samples)
samples$value<-log(samples$value+1)
samples_train<-samples[which(samples$label==0),]
group<-group_by(samples_train,hour,minute)
sta1<-summarise(group,median=median(value),mean=mean(value))
samples<-merge(samples,sta1,by.x = c("hour","minute"),by.y = c("hour","minute"))
samples$diff1<-abs(samples$median-samples$value)
samples$diff2<-abs(samples$mean-samples$value)
View(samples)
tmp_line<-train[which(train$KPI.ID == KPI_IDs[2]),]
tmp_line$datetime<-as.POSIXct(tmp_line$timestamp, origin="1970-01-01")
samples<-NULL
order<-1
for(i in 1:nrow(tmp_line)){
samples$id[order]<-as.character(tmp_line[i,1])
samples$timestamp[order]<-tmp_line[i,"timestamp"]
samples$label[order]<-as.numeric(tmp_line[i,'label'])
samples$hour[order]<-hour(tmp_line[i,"datetime"])
samples$minute[order]<-as.integer(minute(tmp_line[i,"datetime"])/3)
samples$value[order]<-tmp_line[i,"value"]
order<-order+1
}
samples<-data.frame(samples)
samples$value<-log(samples$value+1)
samples_train<-samples[which(samples$label==0),]
group<-group_by(samples_train,hour,minute)
sta1<-summarise(group,median=median(value),mean=mean(value))
samples<-merge(samples,sta1,by.x = c("hour","minute"),by.y = c("hour","minute"))
samples$diff1<-abs(samples$median-samples$value)
samples$diff2<-abs(samples$mean-samples$value)
View(samples)
write.csv(samples,"./samples/samples1.csv",row.names = F,quote = F)
samples$predict<-0
write.csv(samples,"./samples/samples1.csv",row.names = F,quote = F)
View(samples)
View(samples)
View(samples)
